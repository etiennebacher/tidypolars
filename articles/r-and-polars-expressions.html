<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>R and Polars expressions • tidypolars</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="R and Polars expressions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidypolars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.16.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tidypolars.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/how-to-benchmark.html">How to benchmark tidypolars</a></li>
    <li><a class="dropdown-item" href="../articles/r-and-polars-expressions.html">R and Polars expressions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/etiennebacher/tidypolars/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>R and Polars expressions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/etiennebacher/tidypolars/blob/main/vignettes/r-and-polars-expressions.Rmd" class="external-link"><code>vignettes/r-and-polars-expressions.Rmd</code></a></small>
      <div class="d-none name"><code>r-and-polars-expressions.Rmd</code></div>
    </div>

    
    
<p>When we use the <code>tidyverse</code>, we use R expressions in
mainly three places: <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>, and
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">am</span> <span class="op">+</span> <span class="va">gear</span> <span class="op">&gt;</span> <span class="va">carb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">mtcars</span>, x <span class="op">=</span> <span class="op">(</span><span class="va">qsec</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qsec</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">qsec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qsec</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">qsec</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This is very convenient but creates a challenge for
<code>tidypolars</code>. While it is possible to convert a Polars
Data/LazyFrame to an R <code>data.frame</code>, apply functions on it
and then convert it back to Polars, it is strongly discouraged to do so
because it doesn’t take advantage of Polars optimizations.</p>
<p>Indeed, Polars comes with dozens of built-in functions for maths
(<code>median</code>, <code>var</code>, <code>arccos</code>, …), string
manipulation (<code>len_chars</code>, <code>starts</code>, …), and
date-time (<code>hour</code>, <code>quarter</code>,
<code>ordinal_day</code>, …). All of these functions are optimized
internally and are ran in parallel under the hood, which will not be the
case if we pass R functions.</p>
<p>However, using these Polars expressions would imply that we need to
learn these new functions and this new syntax. To avoid doing that,
<code>tidypolars</code> will automatically translate R expressions into
Polars ones. Basically, <strong>you can keep writing R expressions in
most situations</strong>, and they will automatically be translated to
Polars syntax.</p>
<p>However, there are some situations where this might not work, so this
vignette explains the process and the limitations.</p>
<div class="section level2">
<h2 id="how-does-tidypolars-translate-r-expressions-into-polars-expressions">How does <code>tidypolars</code> translate R expressions into Polars
expressions?<a class="anchor" aria-label="anchor" href="#how-does-tidypolars-translate-r-expressions-into-polars-expressions"></a>
</h2>
<p>When <code>tidypolars</code> receives an expression, it runs a
function <code>translate()</code> several times until all components are
translated to their Polars equivalent. There are four possible
components: single values, column names, external objects, and
functions.</p>
<div class="section level3">
<h3 id="single-values-column-names-and-external-objects">Single values, column names, and external objects<a class="anchor" aria-label="anchor" href="#single-values-column-names-and-external-objects"></a>
</h3>
<p>If you pass a single value, like <code>x = 1</code> or
<code>x = "a"</code>, it is wrapped into <code>pl$lit()</code>. This is
also the case for external objects with the difference that these need
to be wrapped in <code>{{ }}</code> and are evaluated before being
wrapped into <code>pl$lit()</code>.</p>
<p>Column names, like <code>x = mpg</code>, are wrapped into
<code>pl$col()</code>.</p>
<pre><code>x = "a"               -&gt;  x = pl$lit("a")
x = {{ some_value }}  -&gt;  x = pl$lit(*value*)
x = mpg               -&gt;  x = pl$col("mpg")</code></pre>
</div>
<div class="section level3">
<h3 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h3>
<p>Functions are split into two categories: built-in functions (i.e
functions provided by base R or by other packages), and user-defined
functions (UDF) that are written by the user (you).</p>
<div class="section level4">
<h4 id="built-in-functions">Built-in functions<a class="anchor" aria-label="anchor" href="#built-in-functions"></a>
</h4>
<p>In the first case, <code>tidypolars</code> checks the function name
and whether it has already been translated internally. For example, if
we call the R function <code>mean(x, trim = 2)</code>, then it looks for
a translation of <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>. You can see the list of supported
R functions at the bottom of this vignette. Note that most of essential
base R functions are supported, as well as many functions from
<code>dplyr</code> or from <code>stringr</code> for example.</p>
<p>Now that <code>tidypolars</code> knows that a translation of
<code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> exists, it parses the arguments in the call to
translate them to the Polars syntax: internally, <code>x</code> is
converted to <code>pl$col("x")</code> if there is a column
<code>"x"</code> in the data. Sometimes, additional arguments do not
have an equivalent in Polars. This is the case for the argument
<code>trim</code> here. In this case, <code>tidypolars</code> ignores
this argument and warns the user:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidypolars.etiennebacher.com">tidypolars</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pola-rs.github.io/r-polars/" class="external-link">polars</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://pola-rs.github.io/r-polars/man/as_polars_df.html" class="external-link">as_polars_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span>, trim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #0000BB;">tidypolars</span> doesn't know how to use some arguments of `mean()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The following argument(s) will be ignored: <span style="color: #0000BB;">"trim"</span>.</span></span>
<span><span class="co">#&gt; shape: (32, 12)</span></span>
<span><span class="co">#&gt; ┌──────┬─────┬───────┬───────┬───┬─────┬──────┬──────┬───────────┐</span></span>
<span><span class="co">#&gt; │ mpg  ┆ cyl ┆ disp  ┆ hp    ┆ … ┆ am  ┆ gear ┆ carb ┆ x         │</span></span>
<span><span class="co">#&gt; │ ---  ┆ --- ┆ ---   ┆ ---   ┆   ┆ --- ┆ ---  ┆ ---  ┆ ---       │</span></span>
<span><span class="co">#&gt; │ f64  ┆ f64 ┆ f64   ┆ f64   ┆   ┆ f64 ┆ f64  ┆ f64  ┆ f64       │</span></span>
<span><span class="co">#&gt; ╞══════╪═════╪═══════╪═══════╪═══╪═════╪══════╪══════╪═══════════╡</span></span>
<span><span class="co">#&gt; │ 21.0 ┆ 6.0 ┆ 160.0 ┆ 110.0 ┆ … ┆ 1.0 ┆ 4.0  ┆ 4.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 21.0 ┆ 6.0 ┆ 160.0 ┆ 110.0 ┆ … ┆ 1.0 ┆ 4.0  ┆ 4.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 22.8 ┆ 4.0 ┆ 108.0 ┆ 93.0  ┆ … ┆ 1.0 ┆ 4.0  ┆ 1.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 21.4 ┆ 6.0 ┆ 258.0 ┆ 110.0 ┆ … ┆ 0.0 ┆ 3.0  ┆ 1.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 18.7 ┆ 8.0 ┆ 360.0 ┆ 175.0 ┆ … ┆ 0.0 ┆ 3.0  ┆ 2.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ …    ┆ …   ┆ …     ┆ …     ┆ … ┆ …   ┆ …    ┆ …    ┆ …         │</span></span>
<span><span class="co">#&gt; │ 30.4 ┆ 4.0 ┆ 95.1  ┆ 113.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 2.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 15.8 ┆ 8.0 ┆ 351.0 ┆ 264.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 4.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 19.7 ┆ 6.0 ┆ 145.0 ┆ 175.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 6.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 15.0 ┆ 8.0 ┆ 301.0 ┆ 335.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 8.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; │ 21.4 ┆ 4.0 ┆ 121.0 ┆ 109.0 ┆ … ┆ 1.0 ┆ 4.0  ┆ 2.0  ┆ 20.090625 │</span></span>
<span><span class="co">#&gt; └──────┴─────┴───────┴───────┴───┴─────┴──────┴──────┴───────────┘</span></span></code></pre></div>
<p>This behavior <a href="https://tidypolars.etiennebacher.com/reference/tidypolars-options.html">can
be changed</a> to throw an error instead.</p>
</div>
<div class="section level4">
<h4 id="user-defined-functions">User-defined functions<a class="anchor" aria-label="anchor" href="#user-defined-functions"></a>
</h4>
<p>User-defined functions (UDF) are more challenging. Indeed, it is
technically possible to inspect the code inside a UDF, but rewriting it
to match Polars syntax would be extremely complicated. In this
situation, you will have to rewrite your custom function using Polars
syntax so that it returns a Polars expression. For example, we could
make a function to standardize a column like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl_standardize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">x</span><span class="op">$</span><span class="fu">mean</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="fu">std</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Remember that the column name used as <code>x</code> will end up
wrapped into <code>pl$col()</code>, so to check that your function
returns a Polars expression, you have to provide a <code>pl$col()</code>
call:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pl_standardize</span><span class="op">(</span><span class="va">pl</span><span class="op">$</span><span class="fu">col</span><span class="op">(</span><span class="st">"mpg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [([(col("mpg")) - (col("mpg").mean())]) / (col("mpg").std())]</span></span></code></pre></div>
<p>This function correctly returns a Polars expression, so we can now
use it like any other function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://pola-rs.github.io/r-polars/man/as_polars_df.html" class="external-link">as_polars_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">pl_standardize</span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; shape: (32, 12)</span></span>
<span><span class="co">#&gt; ┌──────┬─────┬───────┬───────┬───┬─────┬──────┬──────┬───────────┐</span></span>
<span><span class="co">#&gt; │ mpg  ┆ cyl ┆ disp  ┆ hp    ┆ … ┆ am  ┆ gear ┆ carb ┆ x         │</span></span>
<span><span class="co">#&gt; │ ---  ┆ --- ┆ ---   ┆ ---   ┆   ┆ --- ┆ ---  ┆ ---  ┆ ---       │</span></span>
<span><span class="co">#&gt; │ f64  ┆ f64 ┆ f64   ┆ f64   ┆   ┆ f64 ┆ f64  ┆ f64  ┆ f64       │</span></span>
<span><span class="co">#&gt; ╞══════╪═════╪═══════╪═══════╪═══╪═════╪══════╪══════╪═══════════╡</span></span>
<span><span class="co">#&gt; │ 21.0 ┆ 6.0 ┆ 160.0 ┆ 110.0 ┆ … ┆ 1.0 ┆ 4.0  ┆ 4.0  ┆ 0.150885  │</span></span>
<span><span class="co">#&gt; │ 21.0 ┆ 6.0 ┆ 160.0 ┆ 110.0 ┆ … ┆ 1.0 ┆ 4.0  ┆ 4.0  ┆ 0.150885  │</span></span>
<span><span class="co">#&gt; │ 22.8 ┆ 4.0 ┆ 108.0 ┆ 93.0  ┆ … ┆ 1.0 ┆ 4.0  ┆ 1.0  ┆ 0.449543  │</span></span>
<span><span class="co">#&gt; │ 21.4 ┆ 6.0 ┆ 258.0 ┆ 110.0 ┆ … ┆ 0.0 ┆ 3.0  ┆ 1.0  ┆ 0.217253  │</span></span>
<span><span class="co">#&gt; │ 18.7 ┆ 8.0 ┆ 360.0 ┆ 175.0 ┆ … ┆ 0.0 ┆ 3.0  ┆ 2.0  ┆ -0.230735 │</span></span>
<span><span class="co">#&gt; │ …    ┆ …   ┆ …     ┆ …     ┆ … ┆ …   ┆ …    ┆ …    ┆ …         │</span></span>
<span><span class="co">#&gt; │ 30.4 ┆ 4.0 ┆ 95.1  ┆ 113.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 2.0  ┆ 1.710547  │</span></span>
<span><span class="co">#&gt; │ 15.8 ┆ 8.0 ┆ 351.0 ┆ 264.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 4.0  ┆ -0.711907 │</span></span>
<span><span class="co">#&gt; │ 19.7 ┆ 6.0 ┆ 145.0 ┆ 175.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 6.0  ┆ -0.064813 │</span></span>
<span><span class="co">#&gt; │ 15.0 ┆ 8.0 ┆ 301.0 ┆ 335.0 ┆ … ┆ 1.0 ┆ 5.0  ┆ 8.0  ┆ -0.844644 │</span></span>
<span><span class="co">#&gt; │ 21.4 ┆ 4.0 ┆ 121.0 ┆ 109.0 ┆ … ┆ 1.0 ┆ 4.0  ┆ 2.0  ┆ 0.217253  │</span></span>
<span><span class="co">#&gt; └──────┴─────┴───────┴───────┴───┴─────┴──────┴──────┴───────────┘</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="special-case-across">Special case: <code>across()</code><a class="anchor" aria-label="anchor" href="#special-case-across"></a>
</h4>
<p><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link"><code>across()</code></a>
is a very useful function that applies a function (or a list of
functions) to a selection of columns. It accepts built-in functions,
UDFs, and anonymous functions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://pola-rs.github.io/r-polars/man/as_polars_df.html" class="external-link">as_polars_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, stand <span class="op">=</span> <span class="va">pl_standardize</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; shape: (32, 23)</span></span>
<span><span class="co">#&gt; ┌──────┬─────┬───────┬───────┬───┬──────────┬───────────┬────────────┬────────┐</span></span>
<span><span class="co">#&gt; │ mpg  ┆ cyl ┆ disp  ┆ hp    ┆ … ┆ gear_3   ┆ carb_mean ┆ carb_stand ┆ carb_3 │</span></span>
<span><span class="co">#&gt; │ ---  ┆ --- ┆ ---   ┆ ---   ┆   ┆ ---      ┆ ---       ┆ ---        ┆ ---    │</span></span>
<span><span class="co">#&gt; │ f64  ┆ f64 ┆ f64   ┆ f64   ┆   ┆ f64      ┆ f64       ┆ f64        ┆ f64    │</span></span>
<span><span class="co">#&gt; ╞══════╪═════╪═══════╪═══════╪═══╪══════════╪═══════════╪════════════╪════════╡</span></span>
<span><span class="co">#&gt; │ 21.0 ┆ 6.0 ┆ 160.0 ┆ 110.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ 0.735203   ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 21.0 ┆ 6.0 ┆ 160.0 ┆ 110.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ 0.735203   ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 22.8 ┆ 4.0 ┆ 108.0 ┆ 93.0  ┆ … ┆ 0.737804 ┆ 2.8125    ┆ -1.122152  ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 21.4 ┆ 6.0 ┆ 258.0 ┆ 110.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ -1.122152  ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 18.7 ┆ 8.0 ┆ 360.0 ┆ 175.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ -0.503034  ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ …    ┆ …   ┆ …     ┆ …     ┆ … ┆ …        ┆ …         ┆ …          ┆ …      │</span></span>
<span><span class="co">#&gt; │ 30.4 ┆ 4.0 ┆ 95.1  ┆ 113.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ -0.503034  ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 15.8 ┆ 8.0 ┆ 351.0 ┆ 264.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ 0.735203   ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 19.7 ┆ 6.0 ┆ 145.0 ┆ 175.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ 1.97344    ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 15.0 ┆ 8.0 ┆ 301.0 ┆ 335.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ 3.211677   ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; │ 21.4 ┆ 4.0 ┆ 121.0 ┆ 109.0 ┆ … ┆ 0.737804 ┆ 2.8125    ┆ -0.503034  ┆ 1.6152 │</span></span>
<span><span class="co">#&gt; └──────┴─────┴───────┴───────┴───┴──────────┴───────────┴────────────┴────────┘</span></span></code></pre></div>
<p>Similarly, UDFs and anonymous functions will error if they don’t
return a Polars expression:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://pola-rs.github.io/r-polars/man/as_polars_df.html" class="external-link">as_polars_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        mean <span class="op">=</span> <span class="va">mean</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>        <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `mutate()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Could not evaluate an anonymous function in `across()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Are you sure the anonymous function returns a Polars expression?</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="non-translated-functions">Non-translated functions<a class="anchor" aria-label="anchor" href="#non-translated-functions"></a>
</h4>
<p>When a function provided in base R or in another package cannot be
translated, <code>tidypolars</code> usually throws an error (it’s not
necessary to understand what <code><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep()</a></code> does here, you should
only know that it is not translated by <code>tidypolars</code>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">DataFrame</span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span>, foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">foo</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `filter()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #0000BB;">tidypolars</span> doesn't know how to translate this function: `agrep()`</span></span>
<span><span class="co">#&gt;   (from package <span style="color: #0000BB;">base</span>).</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> You can ask for it to be translated here:</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/etiennebacher/tidypolars/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> See `?tidypolars_options` to set automatic fallback to R to handle unknown</span></span>
<span><span class="co">#&gt;   functions.</span></span></code></pre></div>
<p>This is because <code>foo &gt;= agrep("a", a)</code> uses the values
from the columns <code>a</code> and <code>foo</code>, which are stored
in the <code>polars</code> DataFrame. Therefore, <code>polars</code>
needs a translation of <code><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep()</a></code>, which doesn’t exist.</p>
<p>Now, let’s assume that we have this data instead:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">DataFrame</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">foo</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; shape: (1, 1)</span></span>
<span><span class="co">#&gt; ┌─────┐</span></span>
<span><span class="co">#&gt; │ foo │</span></span>
<span><span class="co">#&gt; │ --- │</span></span>
<span><span class="co">#&gt; │ f64 │</span></span>
<span><span class="co">#&gt; ╞═════╡</span></span>
<span><span class="co">#&gt; │ 2.0 │</span></span>
<span><span class="co">#&gt; └─────┘</span></span></code></pre></div>
<p>Starting from <code>tidypolars</code> 0.14.0, this doesn’t error
anymore. Why is that? The reason is that while
<code>foo &gt;= agrep("a", a)</code> uses a column from the data
(<code>foo</code>), <code>agrep("a", a)</code> no longer does since
<code>a</code> is an object in the environment and not in the data
anymore. Therefore, we can evaluate <code>agrep("a", a)</code> first and
then use its result when evaluating
<code>foo &gt;= agrep("a", a)</code>.</p>
<p>More generally, <code>tidypolars</code> checks whether a function
uses columns from the data and skips the translation part if it doesn’t,
allowing us to use more functions than what is translated by
<code>tidypolars</code> (only if they don’t use columns as inputs).</p>
<p>Note that expressions that don’t use the data are evaluated before
running <code>polars</code> in the background so they don’t benefit from
<code>polars</code> parallel evaluation for instance.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="a-note-on-performance">A note on performance<a class="anchor" aria-label="anchor" href="#a-note-on-performance"></a>
</h2>
<p>As we saw above, a large part of the work of <code>tidypolars</code>
is to translate existing R code to its <code>polars</code> equivalent.
This takes some time, especially when translating R expressions used in
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> for instance, and it
might be noticeable if you run <code>tidypolars</code> many times on
small datasets.</p>
<p>This translation process takes more time as the number of expressions
increases but it doesn’t depend on the size of the data. In other words,
translating the code from R to <code>polars</code> takes about the same
time when applied on a dataset of 1M or 10M observations. Therefore,
this drawback should become less and less noticeable as the size of the
dataset increases since most of the time will then be taken by the
actual computation performed by <code>polars</code>.</p>
<div class="section level3">
<h3 id="list-of-base-r-and-tidyverse-functions-supported-by-tidypolars">List of base R and <code>tidyverse</code> functions supported by
<code>tidypolars</code><a class="anchor" aria-label="anchor" href="#list-of-base-r-and-tidyverse-functions-supported-by-tidypolars"></a>
</h3>
<table class="table">
<colgroup>
<col width="3%">
<col width="5%">
<col width="90%">
</colgroup>
<thead><tr class="header">
<th align="left">Package</th>
<th align="left">Function</th>
<th align="left">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>abs</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>acos</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>acosh</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>all</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>any</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>asin</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>asinh</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>as.character</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>as.Date</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>as.logical</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>as.numeric</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>atan</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>atanh</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>ceiling</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>cos</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>cosh</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>cummin</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>cumsum</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>diff</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>exp</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>floor</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>grepl</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>gsub</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>ifelse</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>ISOdatetime</code></td>
<td align="left">In <code>base</code>, when there is an overflow in some
of the components (for example <code>hours = 25</code> or
<code>month = 15</code>), then it returns <code>NA</code>. In Polars,
this errors.</td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>length</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>log</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>log10</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>max</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>mean</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>min</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>nchar</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>paste0</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>paste</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>rank</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>rev</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>round</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>seq</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>seq_len</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>sin</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>sinh</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>sort</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>sqrt</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>strptime</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>substr</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>tan</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>tanh</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>tolower</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>toupper</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>unique</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>base</code></td>
<td align="left"><code>which.min</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>base</code></td>
<td align="left"><code>which.max</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>between</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>case_match</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>case_when</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>coalesce</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>consecutive_id</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>dense_rank</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>first</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>group_keys</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>group_vars</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>if_else</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>lag</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>lead</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>last</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>min_rank</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>n</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>near</code></td>
<td align="left">tidypolars errors if <code>x</code> and <code>y</code>
have different lengths, dplyr doesn’t.</td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>nth</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>n_distinct</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>recode_values</code></td>
<td align="left">The <code>dplyr</code> functions will error if the type
of the replacement doesn’t match the type of the column (for instance
trying to replace a character with an integer). This works in
<code>tidypolars</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>replace_values</code></td>
<td align="left">The <code>dplyr</code> functions will error if the type
of the replacement doesn’t match the type of the column (for instance
trying to replace a character with an integer). This works in
<code>tidypolars</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>replace_when</code></td>
<td align="left">The <code>dplyr</code> function will error if the type
of the replacement doesn’t match the type of the column (for instance
trying to replace a character with an integer). This sometimes works in
<code>tidypolars</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>row_number</code></td>
<td align="left">Doesn’t work when <code>x</code> is missing.</td>
</tr>
<tr class="odd">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>when_all</code></td>
<td align="left">Arguments <code>na_rm</code> and <code>size</code> not
supported.</td>
</tr>
<tr class="even">
<td align="left"><code>dplyr</code></td>
<td align="left"><code>when_any</code></td>
<td align="left">Arguments <code>na_rm</code> and <code>size</code> not
supported.</td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>am</code></td>
<td align="left">Contrarily to <code>lubridate</code>, this doesn’t work
on dates, only datetimes.</td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>day</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>days</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>days_in_month</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>date</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>ddays</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>dhours</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>dmilliseconds</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>dminutes</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>dseconds</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>dweeks</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>force_tz</code></td>
<td align="left">
<code>tidypolars</code> cannot use several timezones in
a single column, while <code><a href="https://lubridate.tidyverse.org/reference/force_tz.html" class="external-link">lubridate::force_tz()</a></code> can.</td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>hours</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>leap_year</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>make_date</code></td>
<td align="left">In <code>lubridate</code>, when there is an overflow in
some of the components (for example <code>hours = 25</code> or
<code>month = 15</code>), then it is automatically converted to the
higher unit (for example 1 day and 1h). In Polars, this errors.</td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>make_datetime</code></td>
<td align="left">In <code>lubridate</code>, when there is an overflow in
some of the components (for example <code>hours = 25</code> or
<code>month = 15</code>), then it is automatically converted to the
higher unit (for example 1 day and 1h). In Polars, this errors.</td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>mday</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>microseconds</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>milliseconds</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>minutes</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>month</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>nanoseconds</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>now</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>pm</code></td>
<td align="left">Contrarily to <code>lubridate</code>, this doesn’t work
on dates, only datetimes.</td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>quarter</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>rollbackward</code></td>
<td align="left">While time zone handling should mimick the behaviour of
<code>lubridate</code> in most cases, it is possible that Polars errors
if rolling back/forward leads to am ambiguous datetime. It is also
possible to have some differences in hours/minutes/seconds when
converting between Polars and R.</td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>rollback</code></td>
<td align="left">While time zone handling should mimick the behaviour of
<code>lubridate</code> in most cases, it is possible that Polars errors
if rolling back/forward leads to am ambiguous datetime. It is also
possible to have some differences in hours/minutes/seconds when
converting between Polars and R.</td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>rollforward</code></td>
<td align="left">While time zone handling should mimick the behaviour of
<code>lubridate</code> in most cases, it is possible that Polars errors
if rolling back/forward leads to am ambiguous datetime. It is also
possible to have some differences in hours/minutes/seconds when
converting between Polars and R.</td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>seconds</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>today</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>wday</code></td>
<td align="left">
<code>week_start</code> must be an integer in
<code>tidypolars</code>. If <code>label = TRUE</code>, it returns a
string variable and not a factor as in <code>lubridate</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>weeks</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>with_tz</code></td>
<td align="left">
<code>tidypolars</code> cannot use several timezones in
a single column, while <code><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">lubridate::with_tz()</a></code> can.
Unrecognized timezones and/or NULL are not supported and will throw an
error.</td>
</tr>
<tr class="even">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>yday</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>lubridate</code></td>
<td align="left"><code>year</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stats</code></td>
<td align="left"><code>median</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stats</code></td>
<td align="left"><code>lag</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stats</code></td>
<td align="left"><code>sd</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stats</code></td>
<td align="left"><code>var</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>regex</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_count</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_detect</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_dup</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_ends</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_equal</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_extract</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_extract_all</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_length</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_pad</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_remove</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_remove_all</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_replace</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_replace_all</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_replace_na</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_split</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_split_i</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_squish</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_starts</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_sub</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_trim</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_to_lower</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_to_title</code></td>
<td align="left">Letters following apostrophe will be capitalized as
well, which differs from the <code>stringr</code> implementation.</td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_to_upper</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>stringr</code></td>
<td align="left"><code>str_trunc</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>stringr</code></td>
<td align="left"><code>word</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>tidyr</code></td>
<td align="left"><code>replace_na</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><code>tools</code></td>
<td align="left"><code>toTitleCase</code></td>
<td align="left">Letters following apostrophe will be capitalized as
well, which differs from the <code>tools</code> implementation.</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.etiennebacher.com" class="external-link">Etienne Bacher</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
