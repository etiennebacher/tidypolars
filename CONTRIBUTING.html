<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Contributing to tidypolars • tidypolars</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Contributing to tidypolars"><meta property="og:image" content="https://tidypolars.etiennebacher.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tidypolars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/tidypolars.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/how-to-benchmark.html">How to benchmark tidypolars</a></li>
    <li><a class="dropdown-item" href="articles/r-and-polars-expressions.html">R and Polars expressions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/etiennebacher/tidypolars/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Contributing to tidypolars</h1>
      <small class="dont-index">Source: <a href="https://github.com/etiennebacher/tidypolars/blob/main/.github/CONTRIBUTING.md" class="external-link"><code>.github/CONTRIBUTING.md</code></a></small>
    </div>

<div id="contributing-to-tidypolars" class="section level1">

<p>This outlines how to propose a change to <strong>tidypolars</strong>.</p>
<div class="section level2">
<h2 id="fixing-typos">Fixing typos<a class="anchor" aria-label="anchor" href="#fixing-typos"></a></h2>
<p>Small typos or grammatical errors in vignettes can be fixed directly on the Github interface since vignettes are automatically rendered by <code>pkgdown</code>.</p>
<p>Fixing typos in the documentation of functions (those in the “Reference” page) requires editing the source in the corresponding <code>.R</code> file and then run <code>devtools::document()</code>. <em>Do not edit an <code>.Rd</code> file in <code>man/</code></em>.</p>
</div>
<div class="section level2">
<h2 id="filing-an-issue">Filing an issue<a class="anchor" aria-label="anchor" href="#filing-an-issue"></a></h2>
<p>The easiest way to propose a change or new feature is to file an issue. If you’ve found a bug, you may also create an associated issue. If possible, try to illustrate your proposal or the bug with a minimal <a href="https://www.tidyverse.org/help/#reprex" class="external-link">reproducible example</a>.</p>
</div>
<div class="section level2">
<h2 id="pull-requests">Pull requests<a class="anchor" aria-label="anchor" href="#pull-requests"></a></h2>
<div class="section level3">
<h3 id="general-information">General information<a class="anchor" aria-label="anchor" href="#general-information"></a></h3>
<ul><li>Please create a Git branch for each pull request (PR).</li>
<li>tidypolars uses <a href="https://cran.r-project.org/package=roxygen2" class="external-link">roxygen2</a>, with <a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/rd-formatting.html" class="external-link">Markdown syntax</a>, for documentation.</li>
<li>If your PR is a user-visible change, you may add a bullet point in <code>NEWS.md</code> describing the changes made. You may optionally add your GitHub username, and links to relevant issue(s)/PR(s).</li>
</ul></div>
<div class="section level3">
<h3 id="how-to-add-support-for-an-r-function-in-tidypolars">How to add support for an R function in <code>tidypolars</code>?<a class="anchor" aria-label="anchor" href="#how-to-add-support-for-an-r-function-in-tidypolars"></a></h3>
<p>If you use a function that is not supported, <code>tidypolars</code> will throw an error. This doesn’t mean that <code>tidypolars</code> cannot support it, simply that it is not implemented yet. <code>tidypolars</code> can technically support hundreds of functions that manipulate numbers, strings, or dates, and those are not limited to the <code>tidyverse</code>.</p>
<p>The first step when you come across an unsupported function is to find the corresponding syntax in <code>polars</code>. Just for the example, suppose that <code><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">stringr::str_ends()</a></code> is not yet supported (it actually is). We first define a simple test <code>data.frame</code> and its <code>DataFrame</code> counterpart in <code>polars</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pola-rs.github.io/r-polars/" class="external-link">polars</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abc"</span>, <span class="st">"a1"</span>, <span class="st">"dac"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test_pl</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">DataFrame</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abc"</span>, <span class="st">"a1"</span>, <span class="st">"dac"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then, find the <code>polars</code> syntax that gives the same output as <code><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">stringr::str_ends()</a></code>. In this case, <code>polars</code> has a string methods <code>$ends_with()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ends_with_c <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_ends</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="do">##   x     ends_with_c</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;lgl&gt;      </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">## 1 abc   TRUE       </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">## 2 a1    FALSE      </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">## 3 dac   TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_pl</span><span class="op">$</span><span class="fu">with_columns</span><span class="op">(</span></span>
<span>  ends_with_c <span class="op">=</span> <span class="va">pl</span><span class="op">$</span><span class="fu">col</span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span><span class="op">$</span><span class="va">str</span><span class="op">$</span><span class="fu">ends_with</span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">## shape: (3, 2)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">## ┌─────┬─────────────┐</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">## │ x   ┆ ends_with_c │</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## │ --- ┆ ---         │</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">## │ str ┆ bool        │</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## ╞═════╪═════════════╡</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## │ abc ┆ true        │</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">## │ a1  ┆ false       │</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">## │ dac ┆ true        │</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## └─────┴─────────────┘</span></span></code></pre></div>
<p>What interests us is the expression inside the <code>$with_columns()</code> call. Now that we know the <code>polars</code> translation, let’s put this in a function that <code>tidypolars</code> will know. Internally, <code>tidypolars</code> will prefix the function name (<code>str_ends</code>) with <code>pl_</code> and look for it in the translated functions.</p>
<p>Depending on the function we translate, it can be stored in different places. This function only works on strings, we can store it in <a href="https://github.com/etiennebacher/tidypolars/blob/main/R/funs-string.R" class="external-link"><code>R/funs-string.R</code></a>. Once we add support for the <code>negate</code> argument, this is what it will look like:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl_str_ends_stringr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">string</span>, <span class="va">pattern</span>, <span class="va">negate</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">check_empty_dots</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">string</span><span class="op">$</span><span class="va">str</span><span class="op">$</span><span class="fu">ends_with</span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="va">negate</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="fu">not</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>You can notice that the new function must be named as <code>pl_&lt;function_name&gt;_&lt;package_name&gt;</code>. This is because multiple packages can export functions with the same name (for example <code><a href="https://rdatatable.gitlab.io/data.table/reference/between.html" class="external-link">data.table::between()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">dplyr::between()</a></code>). Therefore, we want to ensure that our translation is called only if the function comes from a specific package.</p>
<p>The <code>check_empty_dots(...)</code> is here to grab all additional arguments that <code><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">stringr::str_ends()</a></code> might have and ignore them because they have no counterparts in <code>polars</code> (it also adds a message warning the user that these arguments are not used).</p>
<p>Once the package is reloaded, we can use this function in a <code>tidypolars</code> workflow:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidypolars.etiennebacher.com">tidypolars</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_pl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ends_with_c <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_ends</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="do">## shape: (3, 2)</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="do">## ┌─────┬─────────────┐</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="do">## │ x   ┆ ends_with_c │</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="do">## │ --- ┆ ---         │</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="do">## │ str ┆ bool        │</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="do">## ╞═════╪═════════════╡</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="do">## │ abc ┆ true        │</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="do">## │ a1  ┆ false       │</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="do">## │ dac ┆ true        │</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="do">## └─────┴─────────────┘</span></span></code></pre></div>
<p>Finally, the only thing left to do is to add some tests in the <code>tests/testthat</code> folder.</p>
</div>
<div class="section level3">
<h3 id="testing-changes">Testing changes<a class="anchor" aria-label="anchor" href="#testing-changes"></a></h3>
<p><code>tidypolars</code> uses <a href="https://cran.r-project.org/web/packages/testthat/" class="external-link"><code>testthat</code></a> to check that functions have the expected output. If changes affect the behavior of some functions (for example when adding an extra argument), add some tests in the related file in <code>tests/testthat</code>.</p>
<p><code>tidyverse</code> functions that apply to an entire dataframe (e.g., <code>drop_na()</code>) have their own test file (<code>test-drop_na.R</code> in this case).</p>
<p>Functions that apply to one or multiple vectors only (i.e. functions that are used in <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code>, etc.) are tested in specific files. If you added a function in <code>R/funs-string.R</code>, then you should add tests in <code>tests/testthat/test-funs_string.R</code> (same for datetime functions, etc.).</p>
<p>No matter the type of function you added or modified, you should only write tests on Polars DataFrames. Those will be automatically modified when running the tests to run on LazyFrames as well (for instance, the file <code>test-drop_na-lazy.R</code> will be automatically generated).</p>
</div>
<div class="section level3">
<h3 id="pr-title">PR title<a class="anchor" aria-label="anchor" href="#pr-title"></a></h3>
<p>Please follow <a href="https://www.conventionalcommits.org/en/v1.0.0/" class="external-link">Conventional Commits</a> for PR titles, meaning that your PR titles must start with “feat:”, “fix:”, or another appropriate name (see the linked documentation). For example:</p>
<ul><li>
<code>feat</code>: A new feature.</li>
<li>
<code>fix</code>: A bug fix.</li>
<li>
<code>docs</code>: Documentation only changes.</li>
<li>
<code>test</code>: Adding missing tests or correcting existing tests.</li>
<li>
<code>chore</code>: Changes to the build process or auxiliary tools and libraries.</li>
<li>
<code>refactor</code>: A code change that neither fixes a bug nor adds a feature.</li>
</ul><p>See the <a href="https://github.com/etiennebacher/tidypolars/pulls?q=sort%3Aupdated-desc+is%3Apr+is%3Aclosed" class="external-link">list of previous PRs</a> for some examples.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.etiennebacher.com" class="external-link">Etienne Bacher</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

