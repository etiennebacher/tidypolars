### [GENERATED AUTOMATICALLY] Update test_unite.R instead.

Sys.setenv('TIDYPOLARS_TEST' = TRUE)

source("helpers.R")
using("tidypolars")

test <- polars::pl$LazyFrame(
  year = 2009:2011,
  month = 10:12,
  day = c(11L, 22L, 28L),
  name_day = c("Monday", "Thursday", "Wednesday")
)

out1 <- unite(test, col = "full_date", year, month, day, sep = "-")

expect_equal_lazy(
   pull(out1, full_date),
   c("2009-10-11", "2010-11-22", "2011-12-28")
)

expect_dim(out1, c(3, 2))

out2 <- unite(test, col = "full_date", year, month, day, sep = "-", remove = FALSE)

expect_dim(out2, c(3, 5))

test2 <- polars::pl$LazyFrame(
  name = c("John", "Jack", "Thomas"),
  middlename = c("T.", NA, "F."),
  surname = c("Smith", "Thompson", "Jones")
)

out3 <- unite(test2, col = "full_name", everything(), sep = " ", na.rm = TRUE)

expect_equal_lazy(
  pull(out3, full_name),
  c("John T. Smith", "Jack  Thompson", "Thomas F. Jones")
)

Sys.setenv('TIDYPOLARS_TEST' = FALSE)